<div class="px-2 mt-40">
  <div class="flex justify-between items-center max-w-6xl mx-auto">
    <!-- Heading -->
    <span class="text-xl font-medium text-gray-800">Things to do in Pakistan</span>

    <!-- Navigation Links -->
    <div class="flex items-center space-x-2">
      <h1
        class="text-base font-medium text-gray-800 w-20 text-center cursor-pointer hover:text-green-600 transition-colors duration-300"
        routerLink="/main"
      >
        Home
      </h1>
      <h1
        class="text-sm bg-green-800 text-white w-16 text-center py-1 cursor-pointer hover:bg-green-600 transition-colors duration-300"
      >
        Tour
      </h1>
    </div>
  </div>
</div>

<div class="flex bg-gray-50 flex-wrap justify-center">
  <!-- cards -->

  <!-- Loader Skeleton Section -->
  <ng-container *ngIf="isloader">
    <div class="flex flex-col justify-center items-center space-y-6 w-full p-4">
      <div
        *ngFor="let skeleton of skeletonArray"
        class="w-full max-w-4xl bg-white shadow-lg overflow-hidden rounded-lg animate-pulse hover:-translate-y-2 transition-transform duration-300"
      >
        <div class="flex flex-col md:flex-row sm:flex-row">
          <!-- ðŸ–¼ï¸ Image Skeleton -->
          <div
            class="w-full md:w-[14rem] lg:w-[12rem] h-[200px] md:h-auto bg-gray-300"
          >
            <ngx-skeleton-loader
              appearance="line"
              [theme]="{ height: '100%', 'border-radius': '0' }"
              [count]="1"
              class="w-full h-full"
            >
            </ngx-skeleton-loader>
          </div>

          <!-- ðŸ“ Center Content -->
          <div class="lg:w-2/3 md:w-2/5 mx-2 py-4 space-y-3">
            <!-- Title -->
            <div class="h-4 w-1/2 bg-gray-300 rounded"></div>
            <!-- Description -->
            <div class="h-3 w-3/4 bg-gray-300 rounded"></div>

            <!-- Icons Row -->
            <div class="flex mt-3 justify-around">
              <div
                *ngFor="let i of [1, 2, 3]"
                class="flex flex-col items-center"
              >
                <div class="h-6 w-6 bg-gray-300 rounded-sm"></div>
                <div class="w-10 h-2 bg-gray-300 rounded mt-1"></div>
              </div>
            </div>
          </div>

          <!-- ðŸ’° Price & Button -->
          <div
            class="md:w-[22%] bg-slate-100 lg:bg-white lg:border-l-2 lg:border-slate-200 p-4 flex flex-col justify-center items-center space-y-2"
          >
            <div class="w-24 h-3 bg-gray-300 rounded"></div>
            <div class="w-20 h-4 bg-gray-300 rounded"></div>
            <div class="w-16 h-6 bg-gray-300 rounded"></div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>

  <ng-container *ngIf="!isloader">
    <div class="p-4 space-y-3">
      <div
        class="max-w-4xl transition-transform transform hover:-translate-y-2 duration-300 cursor-pointer mx-auto bg-white shadow-lg overflow-hidden"
        *ngFor="let item of displayedProducts"
      >
        <div class="flex flex-col md:flex-row sm:flex-row">
          <div class=" ">
            <div class="flex items-center">
              <div
                class="w-[100vw] h-[100%] lg:w-[13rem] lg:h-[90%] md:w-[17rem]"
              >
                <a [routerLink]="['/products', item?.id]">
                  <img
                    class="w-full h-full object-cover p-1"
                    [src]="item.image"
                    alt=""
                  />
                </a>
              </div>
               <div *ngIf="item.discountPercentage" class="absolute top-1 bg-green-600 text-white text-xs font-bold px-2 py-1 shadow-md">
      {{item.discountPercentage}}% OFF
    </div>
            </div>
          </div>

          <div class="lg:w-2/3 md:w-2/5 mx-2">
            <h2 class="lg:text-md md:text-sm font-bold text-green-600 ">
              {{ item.title }}
            </h2>
                <div class="text-gray-700 lg:text-sm md:text-xs text-sm mt-1">
  <!-- Mobile view (100 chars) -->
  <span class="md:hidden">
    {{ item.productdescription | slice:0:100 }}
    <span class="text-green-600 hover:underline cursor-pointer whitespace-nowrap">... Read More</span>
  </span>
  
  <!-- Desktop/tablet view (130 chars) -->
  <span class="hidden md:inline">
    {{ item.productdescription | slice:0:130 }}
    <span class="text-green-800  hover:underline cursor-pointer whitespace-nowrap">... Read More</span>
  </span>
</div>

            <div class="flex mt-3 justify-around">
              <div
                *ngFor="let item of icons"
                class="flex flex-col items-center"
              >
                <div
                  [class]="
                    item.bgColor +
                    ' text-white h-6 w-6 flex items-center justify-center rounded-sm'
                  "
                >
                  <i [class]="item.icon + ' text-sm'"></i>
                </div>
                <span class="mt-1 text-xs text-gray-700">{{ item.text }}</span>
              </div>
            </div>
          </div>
               <div class="md:w-[29%] bg-slate-100 lg:bg-slate-100 lg:border-l-2 lg:border-slate-200 lg lg:p-0 p-4 flex flex-col place-content-center justify-center items-center">

  <!-- âœ… Top Line -->
  <ng-container *ngIf="item.discountPercentage !== 0">
    <span class="text-gray-700 font-normal">
      PKR: <span class="line-through text-xs">{{ item.adultBaseprice }}</span>
    </span>

    <div class="text-xs text-slate-500">
      {{ item.discountend | date: 'shortDate' }}
    </div>
  </ng-container>

  <!-- âœ… Price -->
  <span class="text-green-600 text-xl font-bold">
    PKR:
    <ng-container *ngIf="item.discountedTotal === 0; else showDiscounted">
      {{ item.adultBaseprice }}
    </ng-container>
    <ng-template #showDiscounted>
      {{ item.adultBaseprice }}
    </ng-template>
  </span>

  <!-- âœ… Button -->
  <button class="bg-[rgb(39,178,24)] text-white py-1 px-3 text-sm rounded-md mt-1">
    <a [routerLink]="['/products', item?._id]">Book Now</a>
  </button>
</div>


        </div>
      </div>
    </div>
  </ng-container>

  <!-- checkboxes -->
  <div
    class="flex flex-wrap lg:flex-col lg:mt-4 lg:space-x-0 md:space-x-3 space-x-0"
  >
    <div
      class="lg:w-[20vw] md:w-[40vw] bg-white h-auto shadow-lg hover:shadow-2xl p-2 transition-transform duration-300 ease-in-out transform hover:-translate-y-1"
    >
      <div
        class="flex items-center space-x-20 lg:space-x-5 md:space-x-5 sm:space-x-4 p-2 justify-around"
      >
        <h1 class="font-bold text-lg">Tour Categories</h1>
        <i
          class="fa-solid text-xl mt-1 text-green-600 cursor-pointer transform transition-transform duration-300 ease-in-out"
          [ngClass]="
            checkbox ? 'fa-circle-minus rotate-0' : 'fa-circle-plus rotate-180'
          "
          (click)="toggleCheckbox()"
        ></i>
      </div>
      <hr class="transition-all duration-300" />
      <div
        class="space-y-3 mt-3 p-2 transition-all duration-500 ease-in-out"
        *ngIf="checkbox"
      >
        <div
          *ngFor="let city of uniqueCities"
          class="flex items-center rounded-md p-2 bg-slate-100 hover:bg-green-600 group transition-transform duration-300 ease-in-out transform hover:-translate-y-1"
        >
         <input
  id="checkbox-{{ city }}"
  type="checkbox"
  class="accent-pink-500 w-4 h-4 rounded-xl cursor-pointer"
  [value]="city"
  (change)="onCityFilterChange($event)"
/>

          <label
            for="checkbox-{{ city }}"
            class="ml-2 text-gray-800 group-hover:text-white cursor-pointer transition-colors duration-300"
          >
            <div class="">{{ city }} ({{ countProductsByCity(city) }})</div>
          </label>
        </div>
      </div>
    </div>

 <div class="lg:w-[20vw] bg-white md:w-[40vw] md:mt-0 lg:mt-5 mt-3 w-[100vw] h-auto shadow-2xl hover:shadow-2xl p-2 mt-9 transition-transform duration-300 ease-in-out transform hover:-translate-y-1">
        <div class="flex items-center justify-between p-2">
          <h1 class="font-bold text-lg">Subcategory Filters</h1>
          <i
            class="fa-solid text-xl text-green-600 cursor-pointer transform transition-transform duration-300 ease-in-out"
            [ngClass]="checkbox2 ? 'fa-circle-minus rotate-0' : 'fa-circle-plus rotate-180'"
            (click)="toggleCheckbox2()"
          ></i>
        </div>
        <hr class="border-gray-300 my-2" />
        <div *ngFor="let item of displayedProducts" class="space-y-1">
          <div
          *ngIf="checkbox2" class="group flex items-center p-2 rounded-md cursor-pointer hover:bg-green-600 transition-transform duration-300 ease-in-out transform hover:-translate-y-1"
          >
            <i class="fa-solid fa-star text-red-500 group-hover:text-white"></i>
            <p class="line-clamp-1 ml-2 text-sm group-hover:text-white">
              <a [routerLink]="['/products', item?._id]">
                {{item.producttitle}}
              </a>
            </p>
          </div>
        </div> 
      </div>
  </div>


  
</div>
