<h1 class="text-2xl font-bold p-5">Orders</h1>
<div class="p-3">
  <ng-container *ngIf="!isloader" class="">
  <div class="text-xs">
    <!-- ðŸ” Filters -->
 <!-- ðŸ” Filters -->
<div class="flex flex-wrap items-end gap-2 mb-4">
  <!-- ðŸ—“ Date Filter -->
  <div class="relative w-[210px]">
    <input
      type="date"
      id="dateFilter"
      name="dateFilter"
      autocomplete="off"
      [(ngModel)]="selectedDate"
      (change)="applyFilter()"
      class="peer w-full border-2 border-slate-200 bg-slate-50 text-xs rounded-[5px] px-[10px] pt-[14px] pb-[6px] focus:outline-none"
    />
  </div>

  <!-- ðŸŒ† City Filter -->
  <div class="relative w-[210px]">
    <select
      id="cityFilter"
      name="cityFilter"
      autocomplete="off"
      [(ngModel)]="selectedCity"
      (change)="applyFilter()"
      class="peer w-full border-2 border-slate-100 bg-slate-50 text-sm text-black rounded-[5px] px-[10px] pt-[14px] pb-[6px] focus:outline-none"
    >
      <option value="NEW YEAR EVENTS">NEW YEAR EVENTS</option>
      <option value="SAFARI TOURS">SAFARI TOURS</option>
      <option value="COMBO DEALS">COMBO DEALS</option>
      <option value="SEA ADVENTURES">SEA ADVENTURES</option>
      <option value="CITY TOURS">CITY TOURS</option>
      <option value="DHOW CRUISE">DHOW CRUISE</option>
    </select>

    <label
      for="cityFilter"
      [ngClass]="{
        'top-[-8px] text-[11px] bg-[#e8e8e8]': selectedCity,
        'top-[14px] text-xs': !selectedCity
      }"
      class="absolute left-[10px] text-slate-500 font-semibold px-[3px] transition-all duration-200"
    >
      Filter by City:
    </label>
  </div>

  <!-- ðŸ‘¤ Name Filter -->
  <div class="relative w-[210px]">
    <input
      type="text"
      id="nameFilter"
      name="nameFilter"
      autocomplete="off"
      [(ngModel)]="selectedName"
      (input)="applyFilter()"
      placeholder=" "
      class="peer w-full border-2 border-slate-100 bg-slate-50 text-xs rounded-[5px] px-[10px] pt-[18px] pb-[6px] focus:outline-none placeholder-transparent"
    />
    <label
      for="nameFilter"
      class="absolute left-[10px] text-slate-500 font-semibold px-[3px] transition-all duration-200
        peer-placeholder-shown:top-[14px] peer-placeholder-shown:text-xs
        peer-focus:top-[-8px] peer-focus:text-[11px]
        top-[-8px] text-[11px] "
    >
      Filter by Name:
    </label>
  </div>

  <!-- ðŸ“§ Email Filter -->
  <div class="relative w-[210px]">
    <input
      type="text"
      id="emailFilter"
      name="emailFilter"
      autocomplete="off"
      [(ngModel)]="selectedEmail"
      (input)="applyFilter()"
      placeholder=" "
      class="peer w-full border-2 border-slate-200 bg-slate-50 text-xs rounded-[5px] px-[10px] pt-[18px] pb-[6px] focus:outline-none placeholder-transparent"
    />
    <label
      for="emailFilter"
      class="absolute left-[10px] top-[14px] text-slate-500 text-xs font-semibold  px-[3px] transition-all duration-200
        peer-placeholder-shown:top-[14px] 
        peer-placeholder-shown:text-xs 
        peer-focus:top-[-8px] 
        peer-focus:text-[11px] 
        peer-focus:bg-[#e8e8e8]">
      Filter by Email
    </label>
  </div>

  <!-- ðŸ”„ Reset Button -->
  <button
    (click)="resetFilters()"
    class="h-[42px] px-4 bg-black text-white text-xs font-semibold rounded-[5px] shadow-sm 
           hover:bg-neutral-800 transition-all duration-300 ease-in-out">
    Reset Filters
  </button>
</div>


    <!-- ðŸ“‹ Orders Table -->
    <div class="overflow-x-auto rounded-xl">
      <table class="min-w-[700px] w-full text-left text-[#273F4F] bg-white">
        <thead class="text-[11px] uppercase bg-slate-800 text-white tracking-wider">
          <tr>
            <th class="px-3 py-3">Name</th>
            <th class="px-2 py-3">Address</th>
            <th class="px-2 py-3">City</th>
            <th class="px-2 py-3">Date</th>
            <!-- <th class="px-2 py-3">Time</th> -->
            <th class="px-2 py-3">Total</th>
           <th class="px-2 py-3">Action</th>

          </tr> 
        </thead>
        <tbody>
          <tr *ngFor="let user of userSummaries"
              class="group border-b border-slate-300 cursor-pointer hover:bg-indigo-900 transition-colors duration-200">
            <td class="flex items-center gap-2 px-2 py-2 font-medium text-slate-900 whitespace-nowrap">
              <img class="w-8 h-8 rounded-full shadow-md ring-1 ring-slate-100"
                   [src]="user.thumbnail ? 'http://localhost:4000/uploads/' + user.thumbnail : 'assets/default-user.jpg'"
                   alt="User Image">
              <div>
                <div class="text-[13px] font-semibold group-hover:text-white">{{ user.userName }}</div>
                <div class="text-[11px] text-slate-500 group-hover:text-white">{{ user.userEmail }}</div>
              </div>
            </td>
            <td class="px-2 py-2 text-slate-600 group-hover:text-white">
              {{ user.address }}
            </td>
           <td class="px-2 py-2 text-slate-600 group-hover:text-white">
  {{ user.products[user.products.length - 1]?.cityName }}
</td>
           <td class="px-2 py-2 text-slate-600 group-hover:text-white">
  {{ user.products[user.products.length - 1]?.order_date }}
</td>
<!-- <td class="px-2 py-2 text-slate-600 group-hover:text-white">
{{ user.latestOrderTime | date:'hh:mm a' }}</td> -->

           
            <td class="px-2 py-2 text-green-700 font-semibold">
              Pkr:{{ (user.total || 0) + (user.privatetransferprice || 0) }}
            </td>
             <td class="px-2 py-2">
              <a [routerLink]="['/admin/user-details', user.userId]"
                 class="text-[11px] font-semibold text-blue-600 group-hover:text-white hover:underline">
                View Details
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- ðŸ“„ Details Modal -->
    <div *ngIf="showDetails" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
      <div class="bg-white w-[90vw] md:w-[600px] p-5 rounded shadow-lg relative text-sm">
        <h2 class="text-base font-bold text-pink-800 mb-1">Details for {{ selectedUser.userName }}</h2>
        <p class="text-[11px] mb-3 text-slate-600">{{ selectedUser.userEmail }}</p>

        <table class="w-full text-[11px] border border-slate-300 mb-3">
          <thead>
            <tr class="bg-pink-100 text-pink-900">
              <th class="p-2 text-left">Product ID</th>
              <th class="p-2 text-left">Total</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let p of selectedUser.products" class="border-t border-slate-200">
              <td class="p-2">{{ p.productId }}</td>
              <td class="p-2 text-green-700">Rs. {{ p.total }}</td>
            </tr>
          </tbody>
        </table>

        <button (click)="closeDetails()" class="mt-1 px-3 py-1 bg-pink-600 hover:bg-pink-700 text-white rounded">
          Close
        </button>
      </div>
    </div>
  </div>
</ng-container>
</div>






























<!-- Skeleton Loader -->
<ng-container *ngIf="isloader">
  <div class="p-4 place-content-center grid text-xs">
    <div class="max-h-[600px] overflow-y-auto rounded-xl">
      <table class="min-w-full text-left text-[#273F4F] bg-white border border-slate-300">
        <thead class="text-[11px] uppercase bg-slate-800 text-white tracking-wider">
          <tr>
            <th class="px-3 py-3">Name</th>
            <th class="px-2 py-3">Address</th>
            <th class="px-2 py-3">City</th>
            <th class="px-2 py-3">Order-date</th>
            <th class="px-2 py-3">Total</th>
            <th class="px-2 py-3">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let skeleton of skeletonArray" class="animate-pulse border-b border-slate-300">
            <td class="px-3 py-3">
              <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-gray-300 rounded-full"></div>
                <div class="space-y-1">
                  <div class="w-24 h-3 bg-gray-300 rounded"></div>
                  <div class="w-20 h-2 bg-gray-200 rounded"></div>
                </div>
              </div>
            </td>
            <td class="px-2 py-3"><div class="w-24 h-3 bg-gray-300 rounded"></div></td>
            <td class="px-2 py-3"><div class="w-16 h-3 bg-gray-300 rounded"></div></td>
            <td class="px-2 py-3"><div class="w-20 h-3 bg-gray-300 rounded"></div></td>
            <td class="px-2 py-3"><div class="w-16 h-3 bg-gray-300 rounded"></div></td>
            <td class="px-2 py-3"><div class="w-16 h-3 bg-gray-300 rounded"></div></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</ng-container>
